<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="utf-8">
    <title>Assistir</title>
    <style>
        body { background:#0f172a; color:#fff; font-family:Arial; margin:0; text-align:center; padding:20px; }
        iframe { width:90%; max-width:900px; height:500px; border-radius:12px; background:#000; border: 2px solid #334155; }
        .info { margin: 20px auto; max-width: 900px; text-align: left; }
        button { padding:10px 20px; border-radius:6px; border:none; cursor:pointer; font-weight:bold; }
        .btn-fav { background:#eab308; color:#000; margin-right:10px; }
        .btn-voltar { background:#334155; color:#fff; }
    </style>
</head>
<body>

<div id="conteudo">Carregando filme...</div>

<iframe id="player" allowfullscreen></iframe>

<div class="info">
    <button class="btn-fav" onclick="toggleFav()">⭐ Favoritar</button>
    <button class="btn-voltar" onclick="history.back()">⬅ Voltar</button>
    <h1 id="titulo"></h1>
    <p id="detalhes"></p>
    <p id="sinopse"></p>
</div>

<script>
let filmeAtual = null;

async function carregar() {
    const params = new URLSearchParams(location.search);
    const id = params.get("id");

    try {
        const r = await fetch("catalogo.json");
        const lista = await r.json();
        filmeAtual = lista.find(f => f.id == id);

        if (!filmeAtual) {
            document.body.innerHTML = "<h1>Filme não encontrado!</h1><button onclick='history.back()'>Voltar</button>";
            return;
        }

        // Preenche os dados
        document.title = "Assistir: " + filmeAtual.titulo;
        document.getElementById("titulo").textContent = `${filmeAtual.titulo} (${filmeAtual.ano})`;
        document.getElementById("sinopse").textContent = filmeAtual.sinopse;
        document.getElementById("detalhes").textContent = "Gêneros: " + filmeAtual.generos.join(", ");
        document.getElementById("player").src = filmeAtual.link;
        document.getElementById("conteudo").style.display = "none";

    } catch (e) {
        console.error(e);
        document.getElementById("conteudo").textContent = "Erro ao carregar filme.";
    }
}

function toggleFav() {
    let favs = JSON.parse(localStorage.getItem("favs") || "[]");
    if (favs.includes(filmeAtual.id)) {
        favs = favs.filter(id => id !== filmeAtual.id);
        alert("Removido dos favoritos");
    } else {
        favs.push(filmeAtual.id);
        alert("Adicionado aos favoritos!");
    }
    localStorage.setItem("favs", JSON.stringify(favs));
}

carregar();
</script>
</body>
</html>

