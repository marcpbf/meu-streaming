<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Filme</title>
<style>
body{margin:0;background:#000;color:#fff;font-family:Arial}
#banner{height:40vh;background-size:cover;background-position:center}
#content{max-width:1000px;margin:-120px auto 0;padding:20px;position:relative}
#poster{width:200px;border-radius:12px;box-shadow:0 10px 30px #000}
#player{width:100%;margin-top:30px}
.elenco{display:flex;gap:10px;overflow-x:auto;margin-top:30px}
.elenco div{text-align:center;font-size:12px}
.elenco img{width:90px;border-radius:8px}
</style>
</head>

<body>

<div id="app">Carregando...</div>

<script>
const app = document.getElementById("app");
const id = new URLSearchParams(location.search).get("id");
const API_KEY = "9a9a8c6e53bf1e6c407b689e729a43c9"; // coloque aqui

console.log("ID:", id);

if(!id){
  app.innerHTML = "Sem ID";
}else{

Promise.all([
  fetch("catalogo.json").then(r=>r.json()),
  fetch(`https://api.themoviedb.org/3/movie/${id}?api_key=${API_KEY}&language=pt-BR`).then(r=>r.json()),
  fetch(`https://api.themoviedb.org/3/movie/${id}/credits?api_key=${API_KEY}&language=pt-BR`).then(r=>r.json())
])
.then(([lista, filme, creditos])=>{
  console.log("CATALOGO OK:", lista.length);
  console.log("TMDB FILME:", filme);
  console.log("TMDB CREDITOS:", creditos);

  const local = lista.find(f=>f.id==id);
  if(!local){
    app.innerHTML = "Filme não existe no catálogo";
    return;
  }

  const backdrop = filme.backdrop_path 
    ? "https://image.tmdb.org/t/p/original"+filme.backdrop_path 
    : "";

  const poster = filme.poster_path 
    ? "https://image.tmdb.org/t/p/w500"+filme.poster_path 
    : local.capa;

  app.innerHTML = `
    <div id="banner" style="background-image:url('${backdrop}')"></div>

    <div id="content">
      <div style="display:flex;gap:20px">
        <img id="poster" src="${poster}">
        <div>
          <h1>${filme.title || local.titulo}</h1>
          <p>${filme.overview || local.sinopse || ""}</p>
        </div>
      </div>

      <video id="player" controls>
        <source src="${local.link}">
      </video>

      <div class="elenco">
        ${(creditos.cast||[]).slice(0,10).map(e=>`
          <div>
            <img src="https://image.tmdb.org/t/p/w185${e.profile_path}">
            <div>${e.name}</div>
          </div>
        `).join("")}
      </div>
    </div>
  `;
})
.catch(err=>{
  console.error("ERRO:", err);
  app.innerHTML = "Erro ao carregar dados (veja o console)";
});

}
</script>
</body>
</html>
