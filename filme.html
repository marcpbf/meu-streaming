<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Filme</title>
<style>
body{margin:0;background:#000;color:#fff;font-family:Arial}
#banner{height:40vh;background-size:cover;background-position:center}
#content{max-width:1000px;margin:-120px auto 0;padding:20px;position:relative}
#poster{width:200px;border-radius:12px;box-shadow:0 10px 30px #000}
#player{width:100%;margin-top:30px}
.elenco{display:flex;gap:10px;overflow-x:auto;margin-top:30px}
.elenco div{text-align:center;font-size:12px}
.elenco img{width:90px;border-radius:8px}
button:focus{
  outline:none;
  background:#22c55e;
  color:#000;
}
</style>
</head>

<body>

<div id="app">Carregando...</div>

<script>
const app = document.getElementById("app");
const id = new URLSearchParams(location.search).get("id");
const API_KEY = "9a9a8c6e53bf1e6c407b689e729a43c9"; // coloque aqui

console.log("ID:", id);

if(!id){
  app.innerHTML = "Sem ID";
  setTimeout(()=>{
  const btn = document.getElementById("externo");
  if(btn){
    btn.onclick = () => {
      window.location.href = local.link;
    };
  }
},100);
}else{

Promise.all([
  fetch("catalogo.json").then(r=>r.json()),
  fetch(`https://api.themoviedb.org/3/movie/${id}?api_key=${API_KEY}&language=pt-BR`).then(r=>r.json()),
  fetch(`https://api.themoviedb.org/3/movie/${id}/credits?api_key=${API_KEY}&language=pt-BR`).then(r=>r.json())
])
.then(([lista, filme, creditos])=>{
  console.log("CATALOGO OK:", lista.length);
  console.log("TMDB FILME:", filme);
  console.log("TMDB CREDITOS:", creditos);

  const local = lista.find(f=>f.id==id);
  if(!local){
    app.innerHTML = "Filme n√£o existe no cat√°logo";
    return;
  }

  const backdrop = filme.backdrop_path 
    ? "https://image.tmdb.org/t/p/original"+filme.backdrop_path 
    : "";

  const poster = filme.poster_path 
    ? "https://image.tmdb.org/t/p/w500"+filme.poster_path 
    : local.capa;

  app.innerHTML = `
    <div id="banner" style="background-image:url('${backdrop}')"></div>

    <div id="content">
      <div style="display:flex;gap:20px">
        <img id="poster" src="${poster}">
        <div>
          <h1>${filme.title || local.titulo}</h1>
<p style="color:#aaa;margin-top:8px">
  üìÖ ${filme.release_date?.slice(0,4)} ‚Ä¢ 
  ‚è± ${filme.runtime} min ‚Ä¢ 
  ‚≠ê ${filme.vote_average.toFixed(1)} 
  (${filme.vote_count} votos)
</p>

<p style="margin-top:10px">
  üé≠ ${filme.genres.map(g=>g.name).join(", ")}
</p>

<p style="margin-top:15px">
  ${filme.overview || local.sinopse || ""}
</p>
        </div>
      </div>

      <video id="player" controls>
  <source src="${local.link}">
</video>

<div style="margin-top:15px;display:flex;gap:15px;flex-wrap:wrap">
  <button id="externo" tabindex="0"
  style="padding:12px 20px;font-size:16px;border-radius:8px;border:none">
  ‚ñ∂Ô∏è Abrir no player externo
</button>
</div>
      <div class="elenco">
        ${(creditos.cast||[]).slice(0,10).map(e=>`
          <div>
            <img src="https://image.tmdb.org/t/p/w185${e.profile_path}">
            <div>${e.name}</div>
          </div>
        `).join("")}
      </div>
    </div>
  `;
})
.catch(err=>{
  console.error("ERRO:", err);
  app.innerHTML = "Erro ao carregar dados (veja o console)";
});

}
</script>
</body>
</html>

