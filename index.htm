<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="utf-8">
<title>Meu Streaming</title>
<style>
body { background:#0f172a; color:#fff; font-family:Arial; margin:0; padding:20px }
h2 { margin-bottom:10px }

#topbar { display:flex; gap:10px; margin-bottom:20px }
input, select, button {
  padding:8px;
  border-radius:6px;
  border:none;
  font-size:14px;
}

.grid {
  display:grid;
  grid-template-columns:repeat(auto-fill,180px);
  gap:20px;
}

.card {
  cursor:pointer;
  transition:.2s;
  outline:none;
}
.card:hover { transform:scale(1.08) }
.card:focus {
  outline:3px solid #38bdf8;
  transform:scale(1.1);
}

.card img {
  width:180px;
  border-radius:12px;
  box-shadow:0 10px 25px rgba(0,0,0,.6);
}

.card p {
  font-size:13px;
  margin-top:6px;
  text-align:center;
}
</style>
</head>
<body>

<h2>üé¨ Meu Streaming</h2>

<div id="topbar">
  <input id="busca" placeholder="Buscar filme...">
  <select id="genero">
    <option value="">Todos os g√™neros</option>
  </select>
  <button onclick="mostrarFavoritos()">‚≠ê Favoritos</button>
  <button onclick="render(filmes)">üìÇ Todos</button>
</div>

<div id="grid" class="grid"></div>

<script>
let filmes = [];
let pos = 0;

fetch("catalogo.json")
.then(r=>r.json())
.then(lista=>{
  filmes = lista;
  montarGeneros(lista);
  render(lista);
});

function montarGeneros(lista){
  const generos = new Set();
  lista.forEach(f => f.generos.forEach(g => generos.add(g)));
  generos.forEach(g=>{
    const op = document.createElement("option");
    op.value = g;
    op.textContent = g;
    genero.appendChild(op);
  });
}

function render(lista){
  grid.innerHTML="";
  lista.forEach((f,i)=>{
    const d=document.createElement("div");
    d.className="card";
    d.tabIndex = 0;
    d.innerHTML=`
      <img src="${f.capa}">
      <p>${f.titulo} (${f.ano})</p>
    `;
    d.onclick=()=>location.href="filme.html?id="+f.id;
    grid.appendChild(d);
  });
  pos = 0;
  document.querySelectorAll(".card")[0]?.focus();
}

// Busca + filtro
busca.oninput = filtrar;
genero.onchange = filtrar;

function filtrar(){
  const termo = busca.value.toLowerCase();
  const gen = genero.value;

  const filtrados = filmes.filter(f=>{
    const okTitulo = f.titulo.toLowerCase().includes(termo);
    const okGenero = gen=="" || f.generos.includes(gen);
    return okTitulo && okGenero;
  });

  render(filtrados);
}

// Favoritos
function mostrarFavoritos(){
  const favs = JSON.parse(localStorage.getItem("favs") || "[]");
  const lista = filmes.filter(f => favs.includes(f.id));
  render(lista);
}

// Modo TV (setas)
document.addEventListener("keydown", e => {
  const cards = document.querySelectorAll(".card");
  if(!cards.length) return;

  if(e.key === "ArrowRight") pos++;
  if(e.key === "ArrowLeft") pos--;
  if(e.key === "ArrowDown") pos += 5;
  if(e.key === "ArrowUp") pos -= 5;

  pos = Math.max(0, Math.min(pos, cards.length-1));
  cards[pos].focus();

  if(e.key === "Enter") cards[pos].click();
});
</script>
</body>
</html>
